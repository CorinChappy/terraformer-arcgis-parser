!function(a,b){if("object"==typeof module&&"object"==typeof module.exports&&(exports=module.exports=b(require("terraformer"))),"object"==typeof a.navigator){if(!a.Terraformer)throw new Error("Terraformer.ArcGIS requires the core Terraformer library. https://github.com/esri/Terraformer");a.Terraformer.ArcGIS=b(a.Terraformer)}}(this,function(a){function b(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function c(a){var b,c=0,d=0,e=a.length,f=a[d];for(d;e-1>d;d++)b=a[d+1],c+=(b[0]-f[0])*(b[1]+f[1]),f=b;return c>=0}function d(a){var b=[],d=a.shift();c(d)||d.reverse(),b.push(d);for(var e=0;e<a.length;e++){var f=a[e];c(f)&&d.reverse(),b.push(a[e])}return b}function e(a){for(var b=[],c=0;c<a.length;c++){for(var e=d(a[c]),f=e.length-1;f>=0;f--){var g=e[f];b.push(g)}b.push()}return b}function f(b,c){var d=a.Tools.arrayIntersectsArray(b,c),e=a.Tools.coordinatesContainPoint(b,c[0]);return!d&&e?!0:!1}function g(a){for(var b=[],d=[],e=0;e<a.length;e++){var g=a[e];if(c(g)){var h=[g];b.push(h)}else d.push(g)}for(;d.length;){for(var i=d.pop(),j=!1,k=b.length-1;k>=0;k--){var l=b[k][0];if(f(l,i)){b[k].push(i),j=!0;break}}j||b.push([i.reverse()])}return 1===b.length?{type:"Polygon",coordinates:b[0]}:{type:"MultiPolygon",coordinates:b}}function h(c){var d=c,e={};d.x&&d.y&&(e.type="Point",e.coordinates=[d.x,d.y]),d.points&&(e.type="MultiPoint",e.coordinates=d.points.splice(0)),d.paths&&(1===d.paths.length?(e.type="LineString",e.coordinates=d.paths[0].splice(0)):(e.type="MultiLineString",e.coordinates=d.paths.splice(0))),d.rings&&(e=g(d.rings.splice(0))),d.geometry&&(e.type="Feature",e.geometry=h(d.geometry),e.properties=b(d.attributes)||{});var f=d.geometry?d.geometry.spatialReference:d.spatialReference;return f&&102100===f.wkid&&(e=a.toGeographic(e)),new a.Primitive(e)}function i(c,f){var g,h=c;g=f?f:h.crs===a.MercatorCRS?{wkid:102100}:{wkid:4326};var j,k={};switch(h.type){case"Point":k.x=h.coordinates[0],k.y=h.coordinates[1],k.spatialReference=g;break;case"MultiPoint":k.points=h.coordinates.splice(0),k.spatialReference=g;break;case"LineString":k.paths=[h.coordinates.splice(0)],k.spatialReference=g;break;case"MultiLineString":k.paths=h.coordinates.splice(0),k.spatialReference=g;break;case"Polygon":k.rings=d(h.coordinates.splice(0)),k.spatialReference=g;break;case"MultiPolygon":k.rings=e(h.coordinates.splice(0)),k.spatialReference=g;break;case"Feature":k.geometry=i(h.geometry),k.attributes=b(h.properties);break;case"FeatureCollection":for(k=[],j=0;j<h.features.length;j++)k.push(i(h.features[j]));break;case"GeometryCollection":for(k=[],j=0;j<h.geometries.length;j++)k.push(i(h.geometries[j]))}return k}var j={};return j.parse=h,j.convert=i,j.toGeoJSON=h,j.fromGeoJSON=i,j});